<app-path [lstRutas]="path" />
<div class="content">
  <app-titulo [lstHeader]="titulo" />

  <div class="row barra-menu">
    <div class="col text-end">
      <button role="button" (click)="funcSubmit()" class="btn btn-primary btn-sm ml-1"><i role="img" class="fas fa-save mr-1"></i> Guardar</button>
      <button role="button" (click)="funcCancelar()" class="btn btn-danger btn-sm ml-1"><i role="img" class="fas fa-reply mr-1"></i> Cancelar</button>
    </div>
  </div>
  
  <div class="row">
    <div class="col col-md-6">
      <div class="card mt-3">
        <div class="card-header th d-flex justify-content-between">
          <span> Información General </span>
          <!-- <i role="img" class="far fa-question-circle text-primary"></i> -->
        </div>

        <div class="p-1 row">
          <div class="col-4 col-md-3 td2 text-end">
            Nombre Grupo <small *ngIf="formData.nombre.requerido"><i role="img" class="text-danger">*</i></small>
            <br />
            <small><i role="img" class="text-secondary">alfanumérico</i></small>
          </div>
          <div class="col-8 col-md-9 td2">
            <input
              type="text"
              name="nombre"
              id="nombre"
              class="form-control {{formData.nombre.validacion.resultado == '' ? '' : 'input-danger'}}"
              [(ngModel)]="nombre"
            />
            <sup>
              <i role="img" class=" {{formData.nombre.validacion.resultado == '' ? 'text-secondary' : 'text-danger' }}">
                {{formData.nombre.validacion.resultado == '' ? formData.nombre.descripcion : formData.nombre.validacion.resultado}}
              </i>
            </sup>
          </div>
       

          <div class="col-4 col-md-3 td2 text-end">
            Script Creación <small *ngIf="formData.idscript_creacion.requerido"><i role="img" class="text-danger">*</i></small>
            <br />
            <small><i role="img" class="text-secondary">Selección</i></small>
          </div>
          <div class="col-8 col-md-9 td2 d-flex justify-content-start">
            <div>
              <select [(ngModel)]="idscript_creacion"  [disabled]="true"
                name="idscript_creacion_usuario" id="idscript_creacion_usuario" class="form-control">
                @if(lstScripts.length>0){
                  @for (item of lstScripts; track $index) {
                    <option value="{{item.idscript}}">{{item.nombre}}</option>
                  }
                }@else {
                  <option value=""> -- No hay scripts asignados --</option>
                }
              </select>
               <sup>
                <i role="img" class=" {{formData.idscript_creacion.validacion.resultado == '' ? 'text-secondary' : 'text-danger' }}">
                  {{formData.idscript_creacion.validacion.resultado == '' ? formData.idscript_creacion.descripcion : formData.idscript_creacion.validacion.resultado}}
                </i>
              </sup>
            </div>
            <div>
              <button role="button" class="btn btn-white btn-sm" title="Buscar Grupos" data-bs-toggle="modal" data-bs-target="#ventanaModalGU">
                <i role="img" class="{{iconos.search}}"></i> <span class="link">Buscar Scripts</span></button>
              <br><br>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col col-md-6">
      <div class="card mt-3">
        <div class="card-header th d-flex justify-content-between">
          <span> Opcion del Menú </span>
          <i role="img" class="far fa-question-circle text-primary"></i>
        </div>
        <div class="p-3 row">
          <p>
            Habilita el acceso y da permisos de lectura<sup class="text-info"
              ><strong>R</strong></sup
            >, escritura<sup class="text-primary"><strong>W</strong></sup> y
            borrado<sup class="text-danger"><strong>D</strong></sup> a cada item
            del menú de opciones.
          </p>
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th width="2% text-start">
                  <input
                    class="form-check-input t16"
                    [checked]="selectall"
                    (click)="selectAll()"
                    type="checkbox"
                  />
                </th>
                <th width="2% text-start">R</th>
                <th width="2% text-start">W</th>
                <th width="2% text-start">D</th>
                <th>Opcion</th>
              </tr>
            </thead>
            <tbody class="td">
              @for (item of lstMenu; track $index) {
              <tr class="td">
                <td class="td">
                  <div class="form-checkXXX form-switchXXX">
                    <input
                      class="form-check-input t16"
                      type="checkbox"
                      [(ngModel)]="item.check"
                      [checked]="item.check"
                      role="switch"
                      id="menu{{item.idrol_menu}}"
                    />
                  </div>
                </td>
                <td class="td">
                  <div class="form-checkXXX form-switchXXX">
                    <input
                      class="form-check-input t16"
                      type="checkbox"
                      [(ngModel)]="item.r"
                      [checked]="item.r"
                      role="switch"
                      id="menu{{item.idrol_menu}}"
                    />
                  </div>
                </td>
                <td class="td">
                  <div class="form-checkXXX form-switchXXX">
                    <input
                      class="form-check-input t16"
                      type="checkbox"
                      [(ngModel)]="item.w"
                      [checked]="item.w"
                      role="switch"
                      id="menu{{item.idrol_menu}}"
                    />
                  </div>
                </td>
                <td class="td">
                  <div class="form-checkXXX form-switchXXX">
                    <input
                      class="form-check-input t16"
                      type="checkbox"
                      [(ngModel)]="item.d"
                      [checked]="item.d"
                      role="switch"
                      id="menu{{item.idrol_menu}}"
                    />
                  </div>
                </td>
                <td>
                  @if(item.es_submenu == 1){
                  <strong class="">{{item.nombre}}</strong>
                  }@else {
                  <strong class="text-dark">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  </strong>
                  <span class="">{{item.nombre}}</span>
                  }
                  <!-- <kbd class="bg-white text-dark mr-2">{{item.orden}}</kbd> -->
                </td>
              </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal modal-xl" id="ventanaModalGU" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Lista de Scripts</h5>
        <button role="button" #btnClose type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div #myGrid2 id="myGrid2" class="ag-theme-quartz scrollx" style="height: 400px; min-height: 400px"></div>
      </div>
      <div class="modal-footer">
        <button role="button" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>



